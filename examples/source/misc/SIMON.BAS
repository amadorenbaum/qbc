DECLARE SUB PERDER ()
DECLARE SUB REMARCAR (CUAL!)
DECLARE SUB DIBUJA ()

COMMON SHARED hechas, TODOOK

INICIO:
GOSUB INI
DO
 GOSUB ti
 a = (INT(RND * 4) + 1) * 2
 LOCATE 2, 1
 PRINT a
 PRINT hechas
 COSA$ = LTRIM$(RTRIM$(STR$(a)))
 CAD$ = CAD$ + COSA$
 GOSUB TOCAR
 CADM$ = ""
 FOR I = 1 TO LEN(CAD$)
   FOR NUEVA = 1 TO TIEMPO
     B$ = INKEY$
     IF B$ = CHR$(0) + "P" THEN CADM$ = CADM$ + "2": PLAY "L8O2a": REMARCAR (2): EXIT FOR
     IF B$ = CHR$(0) + "K" THEN CADM$ = CADM$ + "4": PLAY "L8O3c": REMARCAR (4): EXIT FOR
     IF B$ = CHR$(0) + "M" THEN CADM$ = CADM$ + "6": PLAY "L8O4e": REMARCAR (6): EXIT FOR
     IF B$ = CHR$(0) + "H" THEN CADM$ = CADM$ + "8": PLAY "L8O5g": REMARCAR (8): EXIT FOR
     IF B$ = CHR$(27) THEN SYSTEM
   NEXT NUEVA
   LL = I
   GOSUB REVISAR
   IF TODOOK = 0 THEN
         EXIT FOR
   END IF
 NEXT I
 IF TODOOK = 0 THEN GOTO INICIO
 IF CADM$ = CAD$ THEN
   hechas = hechas + 1
   PRINT "BIEN"
   FOR ES = 1 TO 10000
   NEXT ES
 ELSE
   GOSUB PERDER
   EXIT DO
 END IF
LOOP

TOCAR:
 FOR II = 1 TO LEN(CAD$)
 COSA$ = MID$(CAD$, II, 1)
 IF COSA$ = "2" THEN
   PLAY "L8O2A"
   REMARCAR (2)
 ELSEIF COSA$ = "4" THEN
   PLAY "L8O3C"
   REMARCAR (4)
 ELSEIF COSA$ = "6" THEN
   PLAY "L8O4E"
   REMARCAR (6)
 ELSEIF COSA$ = "8" THEN
   PLAY "L8O5G"
   REMARCAR (8)
 END IF
 SLEEP .3
 NEXT II
RETURN

REVISAR:
 IF MID$(CADM$, LL, 1) <> MID$(CAD$, LL, 1) THEN
   GOSUB PERDER
   TODOOK = 0
 END IF
RETURN

PERDER:
   a$ = "PERDISTE:" + STR$(hechas)
   COLOR 9
   PRINT a$
   COLOR 1
   GOSUB ti
   GOSUB ti
RETURN

ti:
FOR JJ = 1 TO TIEMPO
NEXT JJ
RETURN


INI:
hechas = 0
CAD$ = ""
CADM$ = ""
TIEMPO = 100000
TODOOK = 1
FOR JJJ = 1 TO 100
C$ = INKEY$
NEXT JJJ
CLS
RANDOMIZE TIMER
DIBUJA
LOCATE 2, 20
COLOR 9
LOCATE 2, 28
PRINT "COMIENZA"
GOSUB ti
GOSUB ti
LOCATE 2, 28
PRINT "        "
COLOR 1
RETURN

SUB DIBUJA
COLOR 4, 0
LOCATE 5, 30
PRINT "…ÕÕª"
LOCATE 6, 30
PRINT "∫∫"
LOCATE 7, 30
PRINT "»ÕÕº"
COLOR 2, 0
LOCATE 10, 16
PRINT "…ÕÕª"
LOCATE 11, 16
PRINT "∫∫"
LOCATE 12, 16
PRINT "»ÕÕº"
COLOR 7, 0
LOCATE 10, 44
PRINT "…ÕÕª"
LOCATE 11, 44
PRINT "∫∫"
LOCATE 12, 44
PRINT "»ÕÕº"
COLOR 1, 0
LOCATE 15, 30
PRINT "…ÕÕª"
LOCATE 16, 30
PRINT "∫∫"
LOCATE 17, 30
PRINT "»ÕÕº"
END SUB

SUB REMARCAR (CUAL)
IF CUAL = 2 THEN
    COLOR 9, 0
    LOCATE 15, 30
    PRINT "…ÕÕª"
    LOCATE 16, 30
    PRINT "∫∫"
    LOCATE 17, 30
    PRINT "»ÕÕº"
ELSEIF CUAL = 4 THEN
    COLOR 10, 0
    LOCATE 10, 16
    PRINT "…ÕÕª"
    LOCATE 11, 16
    PRINT "∫∫"
    LOCATE 12, 16
    PRINT "»ÕÕº"
ELSEIF CUAL = 6 THEN
    COLOR 15, 0
    LOCATE 10, 44
    PRINT "…ÕÕª"
    LOCATE 11, 44
    PRINT "∫∫"
    LOCATE 12, 44
    PRINT "»ÕÕº"
ELSEIF CUAL = 8 THEN
    COLOR 12, 0
    LOCATE 5, 30
    PRINT "…ÕÕª"
    LOCATE 6, 30
    PRINT "∫∫"
    LOCATE 7, 30
    PRINT "»ÕÕº"
END IF
FOR II = 1 TO 40000
NEXT II
DIBUJA
END SUB

