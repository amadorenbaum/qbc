ctar = 4000
TARDA = ctar
       
ESCALA$ = "CCCDECGGGAGGAGFECDFEDC"
PLAY "L16"
PLAY "O2"
DIM A$(7)
A$(1) = "C": A$(2) = "D": A$(3) = "E": A$(4) = "F": A$(5) = "G": A$(6) = "A": A$(7) = "B"
MUSI = 0
BUENA:
CLS
MUS$ = "N"
IF MUS$ = "S" OR MUS$ = "s" THEN MUSI = 1: TARDA = INT(ctar / 2) ELSE MUSI = 0
IF puntos > 550 THEN TARDA = INT(ctar / 2) ELSE TARDA = ctar
puntos = 0
vidas = 3
NUEVO:
COLOR 3, 1
DIRMIO = 1: FMIO = 22: cmio = 78: NIVMIO = 1
DIREL = 1: FEL = 22: CEL = 2: NIVEL = 1
CLS
LOCATE 1, 1
PRINT STRING$(80, CHR$(219))
LOCATE 3, 7: PRINT STRING$(68, CHR$(219))
LOCATE 6, 13: PRINT STRING$(56, CHR$(219))
LOCATE 9, 19: PRINT STRING$(44, CHR$(219))
LOCATE 12, 26: PRINT STRING$(30, CHR$(219))
LOCATE 21, 7: PRINT STRING$(68, CHR$(219))
LOCATE 18, 13: PRINT STRING$(56, CHR$(219))
LOCATE 15, 19: PRINT STRING$(44, CHR$(219))
LOCATE 12, 26: PRINT STRING$(30, CHR$(219))
LOCATE 23, 1
PRINT STRING$(80, CHR$(219))
FOR i = 2 TO 22
LOCATE i, 1: PRINT CHR$(219)
IF i > 3 AND i < 21 THEN LOCATE i, 7: PRINT CHR$(219): LOCATE i, 74: PRINT CHR$(219)
IF i > 6 AND i < 18 THEN LOCATE i, 13: PRINT CHR$(219): LOCATE i, 68: PRINT CHR$(219)
IF i > 9 AND i < 15 THEN LOCATE i, 19: PRINT CHR$(219): LOCATE i, 62: PRINT CHR$(219)
LOCATE i, 80: PRINT CHR$(219)
NEXT i
LOCATE 3, 41: PRINT "  "
LOCATE 21, 41: PRINT "  "
LOCATE 6, 41: PRINT "  "
LOCATE 18, 41: PRINT "  "
LOCATE 9, 41: PRINT "  "

LOCATE 15, 41: PRINT "  "
LOCATE 12, 7: PRINT "  "
LOCATE 12, 74: PRINT "  "
LOCATE 12, 13: PRINT "  "
LOCATE 12, 68: PRINT "  "
LOCATE 12, 19: PRINT "  "
LOCATE 12, 62: PRINT "  "

LOCATE 2, 4: PRINT STRING$(75, ".")
LOCATE 4, 8: PRINT STRING$(65, ".")
LOCATE 7, 14: PRINT STRING$(53, ".")
LOCATE 10, 20: PRINT STRING$(40, ".")
LOCATE 22, 4: PRINT STRING$(75, ".")
LOCATE 20, 8: PRINT STRING$(65, ".")
LOCATE 17, 14: PRINT STRING$(53, ".")
LOCATE 14, 20: PRINT STRING$(40, ".")
FOR i = 3 TO 21
IF i > 2 AND i < 22 THEN LOCATE i, 2: PRINT ".": LOCATE i, 79: PRINT "."
IF i > 4 AND i < 20 THEN LOCATE i, 8: PRINT ".": LOCATE i, 73: PRINT "."
IF i > 7 AND i < 17 THEN LOCATE i, 14: PRINT ".": LOCATE i, 67: PRINT "."

NEXT i
LOCATE 12, 20: PRINT "."
LOCATE 12, 61: PRINT "."
LOCATE 12, 28: PRINT "vidas : "; vidas
LOCATE 12, 39: PRINT "puntaje : "; puntos
K = 1
DO WHILE vidas > 0
        IF K > 34 THEN K = 1
        c$ = INKEY$
        IF c$ <> "" THEN GOSUB doblo
        GOSUB muevemio
        IF MUSI = 1 THEN GOSUB MUS
        FOR J = 1 TO TARDA
        NEXT J
        IF puntos > 550 THEN GOTO ALLI
        c$ = INKEY$
        IF c$ <> "" THEN GOSUB doblo
        GOSUB muevemio
        FOR J = 1 TO TARDA
        NEXT J
ALLI:
        c$ = INKEY$
        IF c$ <> "" THEN GOSUB doblo
        GOSUB muevemio
        FOR J = 1 TO TARDA
        NEXT J
        c$ = INKEY$
        IF c$ <> "" THEN GOSUB doblo
        GOSUB muevemio
        FOR J = 1 TO TARDA
        NEXT J
        c$ = INKEY$
        IF c$ <> "" THEN GOSUB doblo
        GOSUB mueveel
        K = K + 1
LOOP
CLS
'GOSUB PUN
LOCATE 15, 45: PRINT "SU PUNTAJE FUE  :   "; puntos
LOCATE 18, 45: PRINT "DESEA JUGAR DE NUEVO (S/N)?"
LOCATE 10, 50: COLOR 26: PRINT "G A M E  O V E R"
LOCATE 19, 71: INPUT "", n$
IF n$ = "S" OR n$ = "s" THEN GOTO BUENA
SYSTEM
PUN:
DIM nom$(11), punt(11)
FOR i = 1 TO 10
nom$(i) = NOMa$
punt(i) = 1
NEXT i
jj = 1
WHILE jj <= 10 AND puntos < punt(jj)
jj = jj + 1
WEND
IF jj = 11 THEN GOTO 2170
FOR l = 10 TO jj STEP -1
 punt(l) = punt(l - 1)
 nom$(l) = nom$(l - 1)
 NEXT l
punt(jj) = puntos: nom$(jj) = ""
2170 CLS
 LOCATE 2, 34: PRINT "R A N K I N G"
 LOCATE 4, 10: PRINT "NOMBRE"
 LOCATE 4, 40: PRINT "PUNTAJE"
 FOR i = 1 TO 10
 mm = (i) + 5
 LOCATE mm, 5: PRINT i;
 LOCATE mm, 10: PRINT nom$(i);
 LOCATE mm, 40: PRINT punt(i)
 NEXT i
 IF jj < 11 THEN LOCATE jj + 5, 10: INPUT "", nom$
 nom$(jj) = nom$
 FOR l = 1 TO 10
 NEXT l
RETURN

SYSTEM

MUS:
' deshabilitado
RETURN

veo:
si = 1
FOR i = 1 TO 80
FOR J = 1 TO 24
IF SCREEN(J, i) = 46 THEN si = 0
NEXT J
NEXT i
RETURN

muevemio:
IF puntos >= 543 AND puntos <= 550 THEN GOSUB veo
IF si = 1 THEN GOTO NUEVO
GOSUB BORMIO
GOSUB dibmio
RETURN
BORMIO:
LOCATE FMIO, cmio: PRINT " "
RETURN
dibmio:
OTRA:
IF DIRMIO = 1 THEN X = 1: y = 0
IF DIRMIO = 2 THEN X = 0: y = -1
IF DIRMIO = 3 THEN X = -1: y = 0
IF DIRMIO = 4 THEN X = 0: y = 1
IF SCREEN(FMIO + y, cmio + X) = 219 THEN GOSUB direc: GOTO OTRA
IF SCREEN(FMIO + y, cmio + X) = 46 THEN puntos = puntos + 1: LOCATE 12, 39: PRINT "puntaje : "; puntos

FMIO = FMIO + y
cmio = cmio + X
 IF SCREEN(FMIO, cmio) = 8 THEN GOSUB BORMIO: vidas = vidas - 1: LOCATE 12, 36: PRINT vidas: NIVMIO = 1: NIVEL = 1: FMIO = 22: cmio = 78: FEL = 22: CEL = 2: DIRMIO = 1: DIREL = 1
LOCATE FMIO, cmio: PRINT CHR$(2)
RETURN

direc:
DIRMIO = DIRMIO + 1
IF DIRMIO = 5 THEN DIRMIO = 1
RETURN

doblo:
IF c$ = "k" OR c$ = "K" THEN GOSUB dobloder
IF c$ = "j" OR c$ = "J" THEN GOSUB dobloiz
RETURN
dobloiz:
IF DIRMIO = 1 AND NIVMIO = 1 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 20: GOTO NIV
IF DIRMIO = 1 AND NIVMIO = 2 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 17: GOTO NIV
IF DIRMIO = 1 AND NIVMIO = 3 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 14: GOTO NIV
IF DIRMIO = 3 AND NIVMIO = 1 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 4: GOTO NIV
IF DIRMIO = 3 AND NIVMIO = 2 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 7: GOTO NIV
IF DIRMIO = 3 AND NIVMIO = 3 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 10: GOTO NIV
IF DIRMIO = 2 AND NIVMIO = 1 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 73: GOTO NIV
IF DIRMIO = 2 AND NIVMIO = 2 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 67: GOTO NIV
IF DIRMIO = 2 AND NIVMIO = 3 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 61: GOTO NIV
IF DIRMIO = 4 AND NIVMIO = 1 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 8: GOTO NIV
IF DIRMIO = 4 AND NIVMIO = 2 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 14: GOTO NIV
IF DIRMIO = 4 AND NIVMIO = 3 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 20: GOTO NIV
FINIZ:
RETURN

NIV:
NIVMIO = NIVMIO + 1
IF NIVMIO = 5 THEN NIVMIO = 4
GOTO FINIZ
dobloder:
IF DIRMIO = 1 AND NIVMIO = 2 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 22: GOTO NIVD
IF DIRMIO = 1 AND NIVMIO = 3 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 20: GOTO NIVD
IF DIRMIO = 1 AND NIVMIO = 4 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 17: GOTO NIVD
IF DIRMIO = 3 AND NIVMIO = 2 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 2: GOTO NIVD
IF DIRMIO = 3 AND NIVMIO = 3 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 4: GOTO NIVD
IF DIRMIO = 3 AND NIVMIO = 4 AND (cmio >= 39 AND cmio <= 41) THEN GOSUB BORMIO: FMIO = 7: GOTO NIVD
IF DIRMIO = 2 AND NIVMIO = 2 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 79: GOTO NIVD
IF DIRMIO = 2 AND NIVMIO = 3 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 73: GOTO NIVD
IF DIRMIO = 2 AND NIVMIO = 4 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 67: GOTO NIVD
IF DIRMIO = 4 AND NIVMIO = 2 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 2: GOTO NIVD
IF DIRMIO = 4 AND NIVMIO = 3 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 8: GOTO NIVD
IF DIRMIO = 4 AND NIVMIO = 4 AND (FMIO >= 11 AND FMIO <= 13) THEN GOSUB BORMIO: cmio = 14: GOTO NIVD
FIND:
RETURN
NIVD:
NIVMIO = NIVMIO - 1
IF NIVMIO = 0 THEN NIVMIO = 1
GOTO FIND

 


mueveel:

GOSUB borel
NIVEL = NIVMIO
IF DIREL = 1 AND NIVEL = 1 AND CEL = 40 THEN FEL = 22
IF DIREL = 2 AND NIVEL = 1 AND FEL = 12 THEN CEL = 2
IF DIREL = 3 AND NIVEL = 1 AND CEL = 40 THEN FEL = 2
IF DIREL = 4 AND NIVEL = 1 AND FEL = 12 THEN CEL = 79
IF DIREL = 1 AND NIVEL = 2 AND CEL = 40 THEN FEL = 20
IF DIREL = 2 AND NIVEL = 2 AND FEL = 12 THEN CEL = 8
IF DIREL = 3 AND NIVEL = 2 AND CEL = 40 THEN FEL = 4
IF DIREL = 4 AND NIVEL = 2 AND FEL = 12 THEN CEL = 73
IF DIREL = 1 AND NIVEL = 3 AND CEL = 40 THEN FEL = 17
IF DIREL = 2 AND NIVEL = 3 AND FEL = 12 THEN CEL = 14
IF DIREL = 3 AND NIVEL = 3 AND CEL = 40 THEN FEL = 7
IF DIREL = 4 AND NIVEL = 3 AND FEL = 12 THEN CEL = 67
IF DIREL = 1 AND NIVEL = 4 AND CEL = 40 THEN FEL = 14
IF DIREL = 2 AND NIVEL = 4 AND FEL = 12 THEN CEL = 20
IF DIREL = 3 AND NIVEL = 4 AND CEL = 40 THEN FEL = 10
IF DIREL = 4 AND NIVEL = 4 AND FEL = 12 THEN CEL = 61

GOSUB dibel
RETURN
borel:
LOCATE FEL, CEL: PRINT CHR$(XX)
RETURN
dibel:
otrel:
IF DIREL = 1 THEN X = -1: y = 0
IF DIREL = 2 THEN X = 0: y = -1
IF DIREL = 3 THEN X = 1: y = 0
IF DIREL = 4 THEN X = 0: y = 1
IF SCREEN(FEL + y, CEL + X) = 219 THEN GOSUB direcel: GOTO otrel
FEL = FEL + y
CEL = CEL + X
 IF SCREEN(FEL, CEL) = 2 THEN GOSUB BORMIO: vidas = vidas - 1: LOCATE 12, 36: PRINT vidas: FEL = 22: CEL = 2: FMIO = 22: cmio = 78: DIRMIO = 1: DIREL = 1: NIVMIO = 1: NIVEL = 1
IF SCREEN(FEL, CEL) = 46 THEN XX = 46 ELSE XX = 32
LOCATE FEL, CEL: PRINT CHR$(8)
RETURN
direcel:
DIREL = DIREL + 1
IF DIREL = 5 THEN DIREL = 1
RETURN

